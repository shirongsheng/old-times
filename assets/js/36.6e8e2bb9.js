(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{495:function(s,e,a){"use strict";a.r(e);var n=a(30),r=Object(n.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("1、下载harbor")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("https://github.com/goharbor/harbor/releases\n\n//解压\ntar -xvf harbor-offline-installer-v1.10.10.tgz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("2、修改harbor.yaml")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("//主机访问地址\nhostname: 114.55.174.15:7070\nhttp port也修改为7070\n//数据存储地址\ndata_volume: /root/shirs/harbor/data\n//登录密码\nharbor_admin_password: Harbor12345\n//注释掉https配置\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("3、执行./install.sh脚本")]),s._v(" "),a("p",[s._v("报错Need to upgrade docker package to 17.06.0")]),s._v(" "),a("p",[s._v("提示要升级docker，docker默认版本较低")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("//docker升级\n\n* 注意升级后daemon.json文件格式的变化\n//查询现在docker\nrpm -qa|grep docker\n\ndocker-common-1.13.1-208.git7d71120.el7_9.x86_64\ndocker-client-1.13.1-208.git7d71120.el7_9.x86_64\ndocker-1.13.1-208.git7d71120.el7_9.x86_64\n\n\n//删除\nyum remove docker-common-1.13.1-208.git7d71120.el7_9.x86_64 docker-client-1.13.1-208.git7d71120.el7_9.x86_64 docker-1.13.1-208.git7d71120.el7_9.x86_64\n\n//下载\ncurl -fsSL https://get.docker.com/ | sh\n\n//重启docker并设为开机自启动\nsystemctl restart docker\nsystemctl enable docker\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("安装docker-compose")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("//从github下载太慢可以使用下面的地址\ncurl -L https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\nchmod +x /usr/local/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("然后就可以执行./install.sh了")]),s._v(" "),a("p",[s._v("然后就可以访问harbor了")]),s._v(" "),a("img",{attrs:{src:"/old-times/png/harbor/harbor_1.png"}}),s._v(" "),a("p",[s._v("接下来配置docker私有仓库地址")]),s._v(" "),a("p",[s._v("有加速器的情况要注意写法。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("镜像打tag为ip:port/name:tag")]),s._v(" "),a("p",[s._v("最后docker push即可")]),s._v(" "),a("p",[s._v("docker tag  地址要加端口和项目名。")]),s._v(" "),a("p",[s._v('开始push没带端口的镜像时总报\nhttp: server gave HTTP response to HTTPS client\n网上千篇一律的都是让修改/etc/docker/daemon.json\n添加{"insecure-registries":["114.55.174.15:7070"] }')]),s._v(" "),a("p",[s._v("殊不知我镜像的tag打的不对的情况下，改了根本是没有用的，可能\n只有我犯了这么无知的错误，网上一点信息都没搜到。")]),s._v(" "),a("p",[s._v("最后还是在harbor上查看到push和pull的地址，才打了正确的tag")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker push 114.55.174.15:7070/library/kube-rbac-proxy:v0.8.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("push的时候报错")]),s._v(" "),a("p",[s._v("denied: requested access to the resource is denied")]),s._v(" "),a("p",[s._v("登录以下harBor即可")]),s._v(" "),a("p",[s._v("docker login 114.55.174.15:7070")])])}),[],!1,null,null,null);e.default=r.exports}}]);