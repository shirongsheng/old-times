(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{475:function(s,a,n){"use strict";n.r(a);var e=n(30),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"概要"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[s._v("#")]),s._v(" 概要")]),s._v(" "),n("p",[s._v("对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。")]),s._v(" "),n("p",[s._v("数据量和访问量不大的情况下，mysql访问是非常快的，是否加索引对访问\n影响不大。但是当数据量和访问量剧增的时候，就会发现mysql变慢，\n甚至down掉，这就必须要考虑优化sql了，给数据库建立正确合理的索引，\n是mysql优化的一个重要手段.")]),s._v(" "),n("p",[s._v("面试官:会sql优化吗？\n我:加索引\n面试官:滚！")]),s._v(" "),n("p",[s._v("一直做的系统都没有很大的数据量，所以没有注重sql的性能优化，而面试\n过程中，很怕面试官来一句会sql优化吗，听到这儿心里顿时mmp，但嘴上\n只能怂之又怂的说一句“加索引！”，懂得面试官会烦躁，让你细说，不懂\n的会心有灵犀的不在这个问题上深究，心道又一个菜逼。头疼啊！！")]),s._v(" "),n("h3",{attrs:{id:"造数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#造数据"}},[s._v("#")]),s._v(" 造数据")]),s._v(" "),n("p",[s._v("以下存储过程可以快速的造出大量的数据。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nDROP PROCEDURE IF EXISTS my_insert;\nCREATE PROCEDURE my_insert()\nBEGIN\n   DECLARE n int DEFAULT 1;\n        loopname:LOOP\n            INSERT INTO user_info(id,name,age,gender,address,tel)VALUES(n,'bob',16,2,'深圳',599073);\n            SET n=n+1;\n        IF n=1000000 THEN\n            LEAVE loopname;\n        END IF;\n        END LOOP loopname;\nEND;\nCALL my_insert();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("我分别造了两个表的数据,其中user_info表有150w数据，单表查询时间\n稳定在1.6s左右。")]),s._v(" "),n("img",{attrs:{src:"/old-times/png/sql/1.jpg"}}),s._v(" "),n("p",[s._v("另一个school表有10w数据，单表查询时间在0.08s左右。")]),s._v(" "),n("img",{attrs:{src:"/old-times/png/sql/2.jpg"}}),s._v(" "),n("p",[s._v("两个表中都有且只有一个叫做zhangsan的人，关联两个表查询zhangsan\n的全部个人信息")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("select a.*,b.* from user_info a ,school b where a.`name` = b.`name` and a.`name`='zhangsan'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("此时的查询时间是1s")]),s._v(" "),n("img",{attrs:{src:"/old-times/png/sql/2.jpg"}}),s._v(" "),n("h3",{attrs:{id:"加索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加索引"}},[s._v("#")]),s._v(" 加索引")]),s._v(" "),n("p",[s._v("创建索引操作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//普通索引\nalter table table_name add index index_name (column_list) ;\n//唯一索引\nalter table table_name add unique (column_list) ;\n//主键索引\nalter table table_name add primary key (column_list) ;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("删除索引")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("drop index index_name on table_name ;\n\nalter table table_name drop index index_name ;\n\nalter table table_name drop primary key ;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("通过创建索引的方式给两个表的name字段添加索引，可以有效的看到查询\n时间缩短了。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("alter table school add index name_ (name) ;\n\nalter table user_info add index name_ (name) ;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("img",{attrs:{src:"/old-times/png/sql/4.jpg"}}),s._v(" "),n("h3",{attrs:{id:"sql优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql优化"}},[s._v("#")]),s._v(" sql优化")]),s._v(" "),n("p",[s._v("由上可以看出加索引能够有效的提升我们的查询速度。")])])}),[],!1,null,null,null);a.default=t.exports}}]);